{"ast":null,"code":"import { RecommendationsComponent } from '../../shared/components/recommendations/recommendations.component';\nimport { PersonalDetailsComponent } from './personal-details/personal-details.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/material/dialog\";\nimport * as i2 from \"src/app/services/booking.service\";\nimport * as i3 from \"src/app/services/search.service\";\nimport * as i4 from \"ngx-spinner\";\nimport * as i5 from \"src/app/services/payment.service\";\nimport * as i6 from \"@angular/material/snack-bar\";\n\nfunction BookComponent_ng_container_1_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 5);\n    i0.ɵɵelementStart(2, \"div\", 6);\n    i0.ɵɵtext(3, \" Loading Payment Gateway \");\n    i0.ɵɵelementStart(4, \"div\", 7);\n    i0.ɵɵelement(5, \"span\", 8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n}\n\nfunction BookComponent_ng_container_1_ng_template_2_ng_container_0_app_personal_details_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-personal-details\");\n  }\n}\n\nfunction BookComponent_ng_container_1_ng_template_2_ng_container_0_app_addons_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-addons\");\n  }\n}\n\nfunction BookComponent_ng_container_1_ng_template_2_ng_container_0_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 17);\n    i0.ɵɵelementStart(1, \"p\", 18);\n    i0.ɵɵtext(2, \"BOOKING DETAILS\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"app-cart-box\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nconst _c0 = function () {\n  return {\n    \"max-width\": \"1050px\"\n  };\n};\n\nconst _c1 = function () {\n  return {\n    \"max-width\": \"1150px\"\n  };\n};\n\nfunction BookComponent_ng_container_1_ng_template_2_ng_container_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"app-stepper\", 9);\n    i0.ɵɵelementStart(2, \"section\", 10);\n    i0.ɵɵelementStart(3, \"div\", 11);\n    i0.ɵɵelementStart(4, \"div\", 12);\n    i0.ɵɵelementStart(5, \"div\", 13);\n    i0.ɵɵtemplate(6, BookComponent_ng_container_1_ng_template_2_ng_container_0_app_personal_details_6_Template, 1, 0, \"app-personal-details\", 1);\n    i0.ɵɵtemplate(7, BookComponent_ng_container_1_ng_template_2_ng_container_0_app_addons_7_Template, 1, 0, \"app-addons\", 1);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"div\", 14);\n    i0.ɵɵelementStart(9, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function BookComponent_ng_container_1_ng_template_2_ng_container_0_Template_button_click_9_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext(3);\n      return ctx_r11.goBack();\n    });\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function BookComponent_ng_container_1_ng_template_2_ng_container_0_Template_button_click_11_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r13 = i0.ɵɵnextContext(3);\n      return ctx_r13.onNext();\n    });\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(13, BookComponent_ng_container_1_ng_template_2_ng_container_0_div_13_Template, 4, 0, \"div\", 16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"stepper\", ctx_r5.stepper);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngStyle\", ctx_r5.stepper === ctx_r5.eStepper.confirmation ? i0.ɵɵpureFunction0(7, _c0) : i0.ɵɵpureFunction0(8, _c1));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.stepper === ctx_r5.eStepper.personalDetails);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.stepper === ctx_r5.eStepper.addons);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r5.stepper != ctx_r5.eStepper.confirmation ? \"Back\" : \"Download PDF\", \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r5.stepper != ctx_r5.eStepper.confirmation ? \"Proceed\" : \"Continue browsing\", \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.stepper != ctx_r5.eStepper.confirmation);\n  }\n}\n\nfunction BookComponent_ng_container_1_ng_template_2_app_no_booking_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-no-booking\");\n  }\n}\n\nfunction BookComponent_ng_container_1_ng_template_2_app_ongoing_bookings_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-ongoing-bookings\");\n  }\n}\n\nfunction BookComponent_ng_container_1_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtemplate(0, BookComponent_ng_container_1_ng_template_2_ng_container_0_Template, 14, 9, \"ng-container\", 1);\n    i0.ɵɵtemplate(1, BookComponent_ng_container_1_ng_template_2_app_no_booking_1_Template, 1, 0, \"app-no-booking\", 1);\n    i0.ɵɵtemplate(2, BookComponent_ng_container_1_ng_template_2_app_ongoing_bookings_2_Template, 1, 0, \"app-ongoing-bookings\", 1);\n  }\n\n  if (rf & 2) {\n    const streams_r1 = i0.ɵɵnextContext().ngIf;\n    let tmp_1_0;\n    let tmp_2_0;\n    i0.ɵɵproperty(\"ngIf\", streams_r1.currBookingItem);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !streams_r1.currBookingItem && !((tmp_1_0 = streams_r1.bookingCart == null ? null : streams_r1.bookingCart.bookingItems == null ? null : streams_r1.bookingCart.bookingItems.length) !== null && tmp_1_0 !== undefined ? tmp_1_0 : 0 > 0));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !streams_r1.currBookingItem && ((tmp_2_0 = streams_r1.bookingCart == null ? null : streams_r1.bookingCart.bookingItems == null ? null : streams_r1.bookingCart.bookingItems.length) !== null && tmp_2_0 !== undefined ? tmp_2_0 : 0 > 0));\n  }\n}\n\nfunction BookComponent_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, BookComponent_ng_container_1_ng_container_1_Template, 6, 0, \"ng-container\", 2);\n    i0.ɵɵtemplate(2, BookComponent_ng_container_1_ng_template_2_Template, 3, 3, \"ng-template\", null, 3, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelement(4, \"hr\", 4);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const streams_r1 = ctx.ngIf;\n\n    const _r3 = i0.ɵɵreference(3);\n\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", streams_r1.bookingCart == null ? null : streams_r1.bookingCart.loadingPaymentGateway)(\"ngIfElse\", _r3);\n  }\n}\n\nconst _c2 = function (a0, a1) {\n  return {\n    bookingCart: a0,\n    currBookingItem: a1\n  };\n};\n\nexport var StepperType;\n\n(function (StepperType) {\n  StepperType[StepperType[\"none\"] = 0] = \"none\";\n  StepperType[StepperType[\"personalDetails\"] = 1] = \"personalDetails\";\n  StepperType[StepperType[\"addons\"] = 2] = \"addons\";\n  StepperType[StepperType[\"payment\"] = 3] = \"payment\";\n  StepperType[StepperType[\"confirmation\"] = 4] = \"confirmation\";\n})(StepperType || (StepperType = {}));\n\nexport class BookComponent {\n  constructor(dialog, bookingService, searchService, spinner, paymentService, snackBar) {\n    this.dialog = dialog;\n    this.bookingService = bookingService;\n    this.searchService = searchService;\n    this.spinner = spinner;\n    this.paymentService = paymentService;\n    this.snackBar = snackBar;\n    this.addons = [];\n    this.eStepper = StepperType;\n    this.stepper = this.eStepper.personalDetails;\n    this.currBookingItem$ = this.bookingService.currBookingItem$;\n    this.bookingCart$ = this.bookingService.bookingCart$;\n  }\n\n  ngOnInit() {}\n\n  openRecommendationsDialog() {\n    this.spinner.show();\n    this.searchService.searchRooms(this.bookingService.getRecommendationsSearchParams()).subscribe(res => {\n      this.dialog.open(RecommendationsComponent, {\n        width: '600px',\n        panelClass: ['mat-dialog-custom-dimensions'],\n        data: {\n          searchResult: res\n        }\n      });\n      this.spinner.hide();\n    });\n  }\n\n  getAddressString() {\n    var _a, _b, _c, _d, _e, _f, _g, _h;\n\n    let str = '';\n\n    if ((_a = this.personalDetailsForm.get('address.lane')) === null || _a === void 0 ? void 0 : _a.value) {\n      str += ((_b = this.personalDetailsForm.get('address.lane')) === null || _b === void 0 ? void 0 : _b.value) + ', ';\n    }\n\n    if ((_c = this.personalDetailsForm.get('address.city')) === null || _c === void 0 ? void 0 : _c.value) {\n      str += ((_d = this.personalDetailsForm.get('address.city')) === null || _d === void 0 ? void 0 : _d.value) + ', ';\n    }\n\n    if ((_e = this.personalDetailsForm.get('address.state')) === null || _e === void 0 ? void 0 : _e.value) {\n      str += ((_f = this.personalDetailsForm.get('address.state')) === null || _f === void 0 ? void 0 : _f.value) + ', ';\n    }\n\n    if ((_g = this.personalDetailsForm.get('address.country')) === null || _g === void 0 ? void 0 : _g.value) {\n      str += ((_h = this.personalDetailsForm.get('address.country')) === null || _h === void 0 ? void 0 : _h.value) + ', ';\n    }\n\n    return str;\n  }\n\n  onNext() {\n    if (this.stepper === this.eStepper.personalDetails) {\n      if (this.personalDetailsComponent.personalDetailsForm.valid) {\n        this.personalDetailsForm = this.personalDetailsComponent.personalDetailsForm;\n        this.stepper = this.eStepper.addons;\n        this.openRecommendationsDialog();\n      } else {\n        this.personalDetailsComponent.personalDetailsForm.markAllAsTouched();\n        this.snackBar.open('Please complete the form', '', {\n          duration: 2000\n        });\n      }\n    } else if (this.stepper === this.eStepper.addons) {\n      this.paymentService.createOrderAndMakePayment(this.bookingService.currBookingItemValue, this.personalDetailsForm.value);\n    }\n\n    window.scrollTo(0, 200);\n  }\n\n  goBack() {\n    if (this.stepper === this.eStepper.personalDetails) {\n      history.back();\n    } else if (this.stepper === this.eStepper.addons) {\n      this.stepper = this.eStepper.personalDetails;\n    } else if (this.stepper === this.eStepper.payment) {\n      this.stepper = this.eStepper.addons;\n    }\n\n    window.scrollTo(0, 0);\n  }\n\n  clickFn() {\n    this.stepper = this.eStepper.confirmation;\n    window.scrollTo(0, 0);\n    setTimeout(() => {\n      this.spinner.hide();\n    }, 1000);\n  }\n\n}\n\nBookComponent.ɵfac = function BookComponent_Factory(t) {\n  return new (t || BookComponent)(i0.ɵɵdirectiveInject(i1.MatDialog), i0.ɵɵdirectiveInject(i2.BookingService), i0.ɵɵdirectiveInject(i3.SearchService), i0.ɵɵdirectiveInject(i4.NgxSpinnerService), i0.ɵɵdirectiveInject(i5.PaymentService), i0.ɵɵdirectiveInject(i6.MatSnackBar));\n};\n\nBookComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: BookComponent,\n  selectors: [[\"app-book\"]],\n  viewQuery: function BookComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(PersonalDetailsComponent, 5);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.personalDetailsComponent = _t.first);\n    }\n  },\n  decls: 4,\n  vars: 8,\n  consts: [[1, \"banner-section\"], [4, \"ngIf\"], [4, \"ngIf\", \"ngIfElse\"], [\"elseBookingTemplate\", \"\"], [1, \"contents-section-seperator\"], [1, \"pg-alert-wrapper\"], [\"role\", \"alert\", 1, \"alert\", \"alert-secondary\"], [\"role\", \"status\", 1, \"spinner-border\", \"m-3\", \"mb-0\"], [1, \"sr-only\"], [3, \"stepper\"], [1, \"contents-section\"], [1, \"contents-wrapper\", 3, \"ngStyle\"], [1, \"content-col\"], [2, \"min-height\", \"480px\"], [1, \"btn-row\"], [1, \"btn-main\", 3, \"click\"], [\"class\", \"cart-col\", 4, \"ngIf\"], [1, \"cart-col\"], [1, \"title\"]],\n  template: function BookComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelement(0, \"section\", 0);\n      i0.ɵɵtemplate(1, BookComponent_ng_container_1_Template, 5, 2, \"ng-container\", 1);\n      i0.ɵɵpipe(2, \"async\");\n      i0.ɵɵpipe(3, \"async\");\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpureFunction2(5, _c2, i0.ɵɵpipeBind1(2, 1, ctx.bookingCart$), i0.ɵɵpipeBind1(3, 3, ctx.currBookingItem$)));\n    }\n  },\n  styles: [\".banner-section[_ngcontent-%COMP%]{background-image:url(https://www.cghearth.com/uploads/banner/20170519203337PMbanneraerial1.jpg);background-position:center;background-size:cover;height:40vh;width:100%;min-height:200px;display:flex;align-items:center;justify-content:center}.contents-section-seperator[_ngcontent-%COMP%]{max-width:1000px;margin:50px auto 0}.contents-section[_ngcontent-%COMP%]{padding:50px 15px}.contents-section[_ngcontent-%COMP%]   .contents-wrapper[_ngcontent-%COMP%]{display:flex;max-width:1150px;margin:auto}.contents-section[_ngcontent-%COMP%]   .content-col[_ngcontent-%COMP%]{flex:1;padding:0 25px}.contents-section[_ngcontent-%COMP%]   .cart-col[_ngcontent-%COMP%]{width:100%;max-width:400px;display:flex;flex-direction:column;padding:0 25px;flex:1}.title[_ngcontent-%COMP%]{font-family:\\\"Adobe Caslon Pro\\\";font-weight:bold;letter-spacing:.06em;text-align:left;color:#000;margin-bottom:8px;font-size:16px;padding-left:5px}.btn-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:10px}.pg-alert-wrapper[_ngcontent-%COMP%]{padding:50px 15px;height:60vh;display:flex;align-items:center;justify-content:center}.pg-alert-wrapper[_ngcontent-%COMP%]   .alert[_ngcontent-%COMP%]{width:100%;max-width:1000px;margin:20px auto auto;height:30vh;display:flex;align-items:center;justify-content:center;min-height:100px;flex-direction:column;background:none;border:1px dashed}\"]\n});","map":null,"metadata":{},"sourceType":"module"}